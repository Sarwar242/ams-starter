<VirtualHost *:80>
  ServerName localhost
  ServerAdmin webmaster@localhost

  DocumentRoot /var/www/html/public

  # Enable mod_rewrite for Laravel
  <Directory /var/www/html>
    Options Indexes FollowSymLinks
    AllowOverride All
    Require all granted
    
    <IfModule mod_rewrite.c>
      RewriteEngine On
      RewriteBase /
      RewriteRule ^index\.html$ - [L]
      RewriteCond %{REQUEST_FILENAME} !-f
      RewriteCond %{REQUEST_FILENAME} !-d
      RewriteRule . /index.php [L]
    </IfModule>
  </Directory>

  # Public directory configuration
  <Directory /var/www/html/public>
    Options Indexes FollowSymLinks
    AllowOverride All
    Require all granted
  </Directory>

  # Deny access to storage and bootstrap directories
  <Directory /var/www/html/storage>
    Require all denied
  </Directory>

  <Directory /var/www/html/bootstrap>
    Require all denied
  </Directory>

  # Error and access logs
  ErrorLog ${APACHE_LOG_DIR}/error.log
  CustomLog ${APACHE_LOG_DIR}/access.log combined

  # Enable security headers
  <IfModule mod_headers.c>
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-Content-Type-Options "nosniff"
    Header set X-XSS-Protection "1; mode=block"
  </IfModule>

  # Compression
  <IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript
  </IfModule>
</VirtualHost>
